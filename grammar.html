<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.385">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The Grammar of Experimental Designs - 2&nbsp; Grammar</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<link href="./edibble.html" rel="next">
<link href="./basics.html" rel="prev">
<link href="./figures/logos/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZBRNTDT9WG"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ZBRNTDT9WG', { 'anonymize_ip': true});
</script>

<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="site_libs/vis-9.1.0/vis-network.min.js"></script>
<script src="site_libs/visNetwork-binding-2.1.0/visNetwork.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="stylesheet" href="./assets/fontawesome-free-6.1.1-web/css/font-awesome.min.css">
<script defer="" src="./assets/fontawesome-free-6.1.1-web/js/all.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Grammar</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./" class="sidebar-logo-link">
      <img src="./figures/logos/edibble-website-logo-blue.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The Grammar of Experimental Designs</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/emitanaka/edibble-book" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Basics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./grammar.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Grammar</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./edibble.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Getting started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./management.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Project management</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cookbook.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Cookbook</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#fundamental-terminology" id="toc-fundamental-terminology" class="nav-link active" data-scroll-target="#fundamental-terminology"> <span class="header-section-number">2.1</span> Fundamental terminology</a></li>
  <li><a href="#an-edibble-graph" id="toc-an-edibble-graph" class="nav-link" data-scroll-target="#an-edibble-graph"> <span class="header-section-number">2.2</span> An edibble graph</a></li>
  <li><a href="#an-edibble-table-or-data-frame" id="toc-an-edibble-table-or-data-frame" class="nav-link" data-scroll-target="#an-edibble-table-or-data-frame"> <span class="header-section-number">2.3</span> An edibble table (or data frame)</a></li>
  <li><a href="#sec-ggplot" id="toc-sec-ggplot" class="nav-link" data-scroll-target="#sec-ggplot"> <span class="header-section-number">2.4</span> The (layered) grammar of graphics</a></li>
  <li><a href="#sec-deggust" id="toc-sec-deggust" class="nav-link" data-scroll-target="#sec-deggust"> <span class="header-section-number">2.5</span> Graphics for design of experiments</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/emitanaka/edibble-book/edit/master/grammar.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/emitanaka/edibble-book/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-grammar" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Grammar</span></span></h1>
</div>





<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="blockquote">
<p>Grammar makes language expressive. A language consisting of words and no grammar (statement = word) expresses only as many ideas as there are words. By specifying how words are combined in statements, a grammar expands a language’s scope.</p>
<p>– Wilkinson, 2005, The Grammar of Graphics, 2nd edition</p>
</div>
<p>In this chapter, I describe an object-oriented programming system called “the grammar of experimental designs” that is designed to capture elements of the origin of an experimental data encapsulated in a cognitive framework. The grammar of experimental designs is a term that is heavily influenced by <span class="citation" data-cites="Wilkinson2005-oz">Wilkinson (<a href="references.html#ref-Wilkinson2005-oz" role="doc-biblioref">2005</a>)</span>, who use the term “grammar of graphics” to describe an object-oriented system to create unlimited number of plots from following a relatively small number of rules. The grammar of graphics is adopted across many systems (Julia, Python, R, Tableau and so on) with its most popular interpretation <span class="citation" data-cites="Wickham2010-kt">(<a href="references.html#ref-Wickham2010-kt" role="doc-biblioref">H. Wickham 2010</a>)</span> as the <code>ggplot2</code> R-package <span class="citation" data-cites="ggplot2">(<a href="references.html#ref-ggplot2" role="doc-biblioref">Hadley Wickham 2016</a>)</span>. An overview of <code>ggplot2</code> is given in <a href="#sec-ggplot">Section&nbsp;<span>2.4</span></a>. The grammar of experimental designs leverage aspects of the grammar of graphics for the visualisation of the experimental designs as discussed more extensively in <a href="#sec-deggust">Section&nbsp;<span>2.5</span></a>.</p>
<p>Henceforth, “grammar” refers to the grammar of experimental designs unless explicitly stated otherwise.</p>
<section id="fundamental-terminology" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="fundamental-terminology"><span class="header-section-number">2.1</span> Fundamental terminology</h2>
<p><a href="basics.html#sec-terminology">Section&nbsp;<span>1.1</span></a> describe the basic terminology used in the field of experimental design. We can, however, describe some terms more fundamentally by considering every categorised entity (physical or otherwise) involved in the experiment to be a factor in the design. The two primary roles of a factor are treatments and units; under this categorisation blocks, experimental units and observational units are all just units – the explicit role of the unit is determined implicitly by the relationship of the factors. For example, if a treatment factor is allocated to a plot factor, then the plot is an experimental unit.</p>
<p>In the grammar, a <strong>factor</strong> is an experimental variable manifested as an object with a dual structure: the “head system” and the “root system”. The <strong>head system</strong> characterizes the holistic attributes of the factor (e.g.&nbsp;the label “vaccine” for the treatment factor) and the <strong>root system</strong> is the constitution of the discrete factor levels such that it captures the idiosyncratic semantic features of each level that distinguish itself from other levels (e.g.&nbsp;labels “type A” and “type B” for the two types of vaccine treatment). Every root and head system has an <strong>outer form</strong> that is visible to the user (usually in the form of a vertex or a vector) and an <strong>inner form</strong> that are intrinsic characteristics of the outer form (e.g.&nbsp;id of the levels, the long name of the vaccines, dose level of each vaccine, etc). A factor can be physical (e.g.&nbsp;person, plot, animal and drug), metaphysical (e.g.&nbsp;gender, time and space) or intended response measures. There are three types of information in the inner form: constant, common and specific. The <strong>constant inner form</strong> is the set of variables that cannot be directly modififed by the user; this is generally the IDs of the nodes. The <strong>common inner form</strong> is the set of variables that are common across all factors, e.g.&nbsp;label and class of the node. The <strong>specific inner form</strong> are variables that are set of variables that are specific to the factor – these are stored in a separate table. The inner form is not usually exported in the final design table. In the system, every root system co-exists with a head system in a reciprocal relationship, i.e.&nbsp;any change in the root structure may be reflected as a change in head structure (and vice-versa). A schema of the factor structure is shown in <a href="#fig-factor-structure">Figure&nbsp;<span>2.1</span></a>.</p>
<div id="fig-factor-structure" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/drawn/factor-structure.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 2.1: A schema for the factor structure in the grammar.</figcaption><p></p>
</figure>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Principle 1: Dual structure of factors
</div>
</div>
<div class="callout-body-container callout-body">
<p>All factor must have a dual structure that describes the head (holistic attributes of the factor) and root (constitution of the levels).</p>
</div>
</div>
<p>Every factor in the system is given an <strong>explicit role</strong> stored as a class in the inner quality of the head. The main roles are unit, treatment and record. The relationship between factors assigns an implicit role, e.g.&nbsp;treatment linked as a directed graph to a unit as seen in <a href="#tbl-implicit-role">Table&nbsp;<span>2.1</span></a>.</p>
<div id="tbl-implicit-role" class="anchored">
<table class="table">
<caption>Table 2.1: Implicit role based on the relationship between factors</caption>
<thead>
<tr class="header">
<th style="text-align: left;">A</th>
<th style="text-align: left;">B</th>
<th style="text-align: left;"><span class="math inline">\(A \rightarrow B\)</span> relationship</th>
<th style="text-align: left;">Implicit role for B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">unit</td>
<td style="text-align: left;">unit</td>
<td style="text-align: left;">B is nested in A</td>
<td style="text-align: left;">Nested unit</td>
</tr>
<tr class="even">
<td style="text-align: left;">treatment</td>
<td style="text-align: left;">unit</td>
<td style="text-align: left;">B is applied to A</td>
<td style="text-align: left;">Experimental unit</td>
</tr>
<tr class="odd">
<td style="text-align: left;">record</td>
<td style="text-align: left;">unit</td>
<td style="text-align: left;">B is measured on A</td>
<td style="text-align: left;">Observational unit</td>
</tr>
</tbody>
</table>
</div>
<p>There are two orders of relationships in the system: the <strong>higher-order links</strong> between the factor nodes in the head system and the <strong>lower-order links</strong> between the level nodes in the root system. A higher-order link is created by explicit specification by the user and depending on how it is defined, the system creates the lower-order links between the root nodes with some constraint as prescribed by their explicit role and other user inputs.</p>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Principle 2: Rules for relationships between factors
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li>A higher-order link between any two head nodes must be explicitly specified by the user.</li>
<li>A lower-order link between any two root nodes cannot be made if there is no higher-order link between the head nodes linked to the two root nodes.</li>
</ol>
</div>
</div>
<div id="fig-example-network" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/drawn/example-network.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 2.2: An example network structure.</figcaption><p></p>
</figure>
</div>
<p>In the grammar, an intermediate construct of the experimental design is stored as an object that contain two types of directed graphs, <span class="math inline">\(G_F = (V(G_F), E(G_F))\)</span> and <span class="math inline">\(G_L = (V(G_L), E(G_L))\)</span>, where <span class="math inline">\(V(G_F)\)</span> and <span class="math inline">\(V(G_L)\)</span> are sets of vertices and <span class="math inline">\(E(G_F)\)</span> and <span class="math inline">\(E(G_L)\)</span> are sets of edges. We refer <span class="math inline">\(G_F\)</span> and <span class="math inline">\(G_L\)</span> as factor graph and level graph, respectively. In the <strong>factor graph</strong>, every factor is represented as a single vertex. Every factor has a finite number of levels and each of these levels is represented as a single vertex in the <strong>level graph</strong>.</p>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-3e472bc7543a8d4f0534" style="width:100%;height:200px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-3e472bc7543a8d4f0534">{"x":{"nodes":{"id":[1,2,3,4],"name":["mainplot","subplot","irrigation","fertilizer"],"class":["edbl_unit","edbl_unit","edbl_trt","edbl_trt"],"group":["unit","unit","trt","trt"],"label":["mainplot","subplot","irrigation","fertilizer"],"shape":["circle","circle","diamond","diamond"]},"edges":{"from":[1,3,4],"to":[2,1,2],"alloc":[null,1,2],"type":["nest","allot","allot"],"var_from":["mainplot","irrigation","fertilizer"],"var_to":["subplot","mainplot","subplot"],"arrows.middle.type":["arrow","arrow","arrow"],"dashes":[false,false,false],"arrows":["to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","id":"id"},"manipulation":{"enabled":false},"layout":{"randomSeed":3},"edges":{"id":"id"},"interaction":{"dragNodes":false,"dragView":false,"hover":false,"keyboard":false,"multiselect":false,"navigationButtons":false,"selectable":false,"zoomView":false,"zoomSpeed":1}},"groups":["unit","trt"],"width":"100%","height":"200px","idselection":{"enabled":false},"byselection":{"enabled":false},"main":{"text":"Factor graph for a split plot design","style":"font-weight:bold;text-align:center;"},"submain":{"text":"","style":""},"footer":{"text":"","style":""},"background":"rgba(0, 0, 0, 0)","tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
<p>A factor graph shows a high order view of the relationship between the factors in the experiment. In the above figure, there are two treatment factors: irrigation and fertilizer. Irrigation treatment is applied to the mainplot and the fertilizer treatment is applied to the subplot. The arrow from mainplot node to the subplot node implies that the subplot is nested in the mainplot. The shape and color of the node correspond to the class of the factor (e.g.&nbsp;unit, treatment).</p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-d15facbe8713e15186ee" style="width:100%;height:400px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-d15facbe8713e15186ee">{"x":{"nodes":{"idvar":[1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,4,4],"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"name":["mainplot1","mainplot2","mainplot3","mainplot4","subplot1","subplot2","subplot3","subplot4","subplot5","subplot6","subplot7","subplot8","subplot9","subplot10","subplot11","subplot12","subplot13","subplot14","subplot15","subplot16","rainfed","irrigated","brand-A","brand-B"],"var":["mainplot","mainplot","mainplot","mainplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","irrigation","irrigation","fertilizer","fertilizer"],"label":["mainplot1","mainplot2","mainplot3","mainplot4","subplot1","subplot2","subplot3","subplot4","subplot5","subplot6","subplot7","subplot8","subplot9","subplot10","subplot11","subplot12","subplot13","subplot14","subplot15","subplot16","rainfed","irrigated","brand-A","brand-B"],"group":["mainplot","mainplot","mainplot","mainplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","subplot","irrigation","irrigation","fertilizer","fertilizer"],"shape":["circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","diamond","diamond","diamond","diamond"]},"edges":{"from":[1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,22,21,22,21,23,24,24,23,24,23,23,24,24,24,23,23,23,24,23,24],"to":[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"alloc":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"type":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"lvl_from":["mainplot1","mainplot1","mainplot1","mainplot1","mainplot2","mainplot2","mainplot2","mainplot2","mainplot3","mainplot3","mainplot3","mainplot3","mainplot4","mainplot4","mainplot4","mainplot4","irrigated","rainfed","irrigated","rainfed","brand-A","brand-B","brand-B","brand-A","brand-B","brand-A","brand-A","brand-B","brand-B","brand-B","brand-A","brand-A","brand-A","brand-B","brand-A","brand-B"],"lvl_to":["subplot1","subplot2","subplot3","subplot4","subplot5","subplot6","subplot7","subplot8","subplot9","subplot10","subplot11","subplot12","subplot13","subplot14","subplot15","subplot16","mainplot1","mainplot2","mainplot3","mainplot4","subplot1","subplot2","subplot3","subplot4","subplot5","subplot6","subplot7","subplot8","subplot9","subplot10","subplot11","subplot12","subplot13","subplot14","subplot15","subplot16"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","id":"id"},"manipulation":{"enabled":false},"layout":{"randomSeed":1},"edges":{"id":"id"},"interaction":{"dragNodes":false,"dragView":false,"hover":false,"keyboard":false,"multiselect":false,"navigationButtons":false,"selectable":false,"zoomView":false,"zoomSpeed":1}},"groups":["mainplot","subplot","irrigation","fertilizer"],"width":"100%","height":"400px","idselection":{"enabled":false},"byselection":{"enabled":false},"main":{"text":"Level graph for a split plot design","style":"font-weight:bold;text-align:center;"},"submain":{"text":"","style":""},"footer":{"text":"","style":""},"background":"rgba(0, 0, 0, 0)","tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
<p>The above figure shows the level graph. The nodes of the same color are the levels of the same factor (e.g.&nbsp;all yellow nodes correspond to the levels of the unit, subplot). The shape of the node correspond to the class of the corresponding factor.</p>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Principle 3: All factors must be given an identity
</div>
</div>
<div class="callout-body-container callout-body">
<p>All nodes in the factor graph must be explicitly named.</p>
</div>
</div>
<p>Table <span class="citation" data-cites="tab:exam-table">(<a href="references.html#ref-tab:exam-table" role="doc-biblioref"><strong>tab:exam-table?</strong></a>)</span> shows an example of an illustrative experiment that tests the exam score on a different exam time allocation for two different subjects. In such an experiment, the observational unit may be specified as the combination of Subject-Student, i.e.&nbsp;an observational unit can only be uniquely identified by using information across multiple factors. <strong>In the grammar, a factor cannot be implicitly assumed from other factors.</strong> This restriction means, for example, that a new factor, like Exam Booklet, which uniquely identifies every Subject-Student combination must be specified in the system. This restriction is not only for the purpose of internal graph representation but forces the user to confront what the observational units actually are. Naming things are hard, but without naming things, it can be hard to create a shared understanding about the experimental structure.</p>
<div class="cell">
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>The table below shows the exam time allocation for every subject-student combination.</caption>
 <thead>
  <tr>
   <th style="text-align:right;"> Exam Booklet </th>
   <th style="text-align:left;"> Subject </th>
   <th style="text-align:right;"> Student </th>
   <th style="text-align:right;"> Exam Time </th>
   <th style="text-align:right;"> Score </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Math </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> Morning </td>
   <td style="text-align:right;"> 58 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:left;"> Science </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> Afternoon </td>
   <td style="text-align:right;"> 90 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> Math </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> Afternoon </td>
   <td style="text-align:right;"> 39 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:left;"> Science </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> Morning </td>
   <td style="text-align:right;"> 80 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Principle 4: All factor levels must map to a single observational unit
</div>
</div>
<div class="callout-body-container callout-body">
<p>A viable experimental design is only specified if the relationship between the factors can be reconciled to a single observational unit.</p>
</div>
</div>
</section>
<section id="an-edibble-graph" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="an-edibble-graph"><span class="header-section-number">2.2</span> An edibble graph</h2>
<p>An edibble graph, or <code>edbl_graph</code> object, is a special type of directed graph. This form is used to represent intermediate constructs of the experimental design.</p>
<p>In a <strong><em>factor graph</em></strong>:</p>
<ul>
<li>a vertex is a variable,</li>
<li>an edge is a high-level connection between two variables, and</li>
<li>the direction of an edge defines a relationship based on which two variables it is connecting. Say if we have two nodes named A and B with a directed edge starting from A to B, then the meaning of the relationship follows from <a href="#tbl-implicit-role">Table&nbsp;<span>2.1</span></a>. If the combination is not listed below then the nodes cannot have a direct relationship.</li>
</ul>
<p>As an example, consider a split-plot design that contains 4 main plots with 2 sub plots within each main plot (so 8 subplots in total). There are 2 treatment factors: fertilizer (with levels A and B) and variety (with levels V1 and V2). Each level of the fertilizer is randomly applied to two main plots. Each level of variety is randomly applied to one sub plot within each main plot. Two responses are planned to be measured on the sub plots: yield and height.</p>
<p>In a <strong><em>level graph</em></strong>:</p>
<ul>
<li>a vertex is a level,</li>
<li>an edge is a direct connection between two levels, and</li>
<li>the direction of an edge defines the same relationship as for high-level view, except if the edge is connecting nodes of levels of the same unit variable then it represents the sequence order of the levels.</li>
</ul>
<p>The whole edibble graph object contains all the nodes and edges from the high- and low-level views. The whole edibble graph can have numerous nodes and edges, even when the number of units are small, that it’s visualisation will be too cluttered to be any useful. Consequently, when visualising these intermediate construct of the experimental design, only a high- or low-level view is visible to the user, but the object contains the information seen in both views.</p>
</section>
<section id="an-edibble-table-or-data-frame" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="an-edibble-table-or-data-frame"><span class="header-section-number">2.3</span> An edibble table (or data frame)</h2>
<p>An edibble, or <code>edbl_table</code> object, is a special class of <a href="https://tibble.tidyverse.org/"><code>tibble</code></a>. The word “edibble” itself already implies that it is a table so appending the word with table or data frame seems superfluous. However, edibble can refer to the package, object, or used as an adjective to other objects, so appending edibble with table or data frame is to make explicit emphasis it refers to the <code>edbl_table</code> object, otherwise the reader is expected to infer its meaning by context.</p>
<p>An <code>edbl_table</code> was originally called <code>edbl_df</code> following convention from tibble but I decided to break away from this since other edibble components are <em>graph</em> and <em>design</em>, so a two letter word felt too short in contrast.</p>
<p>An edibble data frame is produced when the variables can be laid out in a <a href="https://www.jstatsoft.org/article/view/v059i10">tidy data</a> format. An edibble is constructed from two possible ways:</p>
<ol type="1">
<li>converting edibble graph to edibble using <code>serve_table</code> and</li>
<li>converting existing data frame to edibble using <code>edibble</code>.</li>
</ol>
</section>
<section id="sec-ggplot" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="sec-ggplot"><span class="header-section-number">2.4</span> The (layered) grammar of graphics</h2>
</section>
<section id="sec-deggust" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="sec-deggust"><span class="header-section-number">2.5</span> Graphics for design of experiments</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-Wickham2010-kt" class="csl-entry" role="doc-biblioentry">
Wickham, H. 2010. <span>“A Layered Grammar of Graphics.”</span> <em>Journal of Computational and Graphical Statistics: A Joint Publication of American Statistical Association, Institute of Mathematical Statistics, Interface Foundation of North America</em>.
</div>
<div id="ref-ggplot2" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-Wilkinson2005-oz" class="csl-entry" role="doc-biblioentry">
Wilkinson, Leland. 2005. <em>The Grammar of Graphics</em>. Springer.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./basics.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Basics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./edibble.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Getting started</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>